<!DOCTYPE HTML>
<html>

<head>
    <script src="../static/code/highcharts.js"></script>
    <script src="../static/code/highcharts-more.js"></script>
    <script src="../static/code/modules/exporting.js"></script>
    <script src="../static/jQuery/jquery.js"></script>
    <script src="../static/css/bootstrap.css"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Highcharts Example</title>

    <style type="text/css">
        .highcharts-tooltip h3 {
            margin: 0.3em 0;
        }
    </style>
</head>

<body>
    <div id="container" style="height: 800px; margin: 0 auto"></div>
    <script type="text/javascript">

        var chart = Highcharts.chart('container', {

            chart: {
                type: 'bubble',
                plotBorderWidth: 2,
                zoomType: 'xy'
            },

            legend: {
                enabled: true
            },

            title: {
                text: "{{chart_title}}"
            },

            xAxis: {
                gridLineWidth: 1,
                title: {
                    text: '{{xAxis["title"]}}'
                },
                labels: {
                    format: '{value} cm'
                },
            },

            yAxis: {
                startOnTick: false,
                endOnTick: false,
                title: {
                    text: '{{yAxis["title"]}}'
                },
                labels: {
                    format: '{value} cm'
                },
                maxPadding: 0.2,
            },

            plotOptions: {
                series: {
                    dataLabels: {
                        enabled: true,
                        format: '{point.name}'
                    }
                }
            },

            series: [{
                data:
                    //{ x: 95, y: 95, name: 'Obj'},
                    {{ data| safe }}
            }]
        });

    </script>

    <!-- Button to calibrate -->
    <button id='calibrate' class="btn btn-danger" type="button" onclick="calibrate()">Calibrate</button>
    <p id='calibrate_text'></p>
    <button id='up' class="btn btn-primary" type="button" onclick="up()">Up</button>
    <button id='down' class="btn btn-primary" type="button" onclick="down()">Down</button>
    <button id='stop' class="btn btn-primary" type="button" onclick="stop()">Stop</button>
    <button id='right' class="btn btn-primary" type="button" onclick="">Right</button>

    <script>
        $(document).keydown(function (e) {
            //document.write(e.which);
            if (e.which == 87) {
                up();
            }
            if (e.which == 83) {
                down();
            }
            if (e.which == 76) {
                calibrate();
            }
        });

        $(document).keydown(function (e) {
            //document.write(e.which);
            if (e.which == 87) {
                stop();
            }
            if (e.which == 83) {
                stop();
            }
        });

        document.addEventListener("keyUp", function (e) {
            stop();
        });

        function calibrate() {
            document.getElementById('calibrate_text').innerHTML = "Start calibration";
            readData();
        }
        function readData() {
            $.getJSON('/send_command', {
                prolang: $('input[name="prolang"]').val(),
            }, function (data) {
                chart.series[0].setData(data);
            });
        }

        function up() {
            $.getJSON('/up', {
                prolang: $('input[name="prolang"]').val(),
            }, function (data) {

            });
        }

        function down() {
            $.getJSON('/down', {
                prolang: $('input[name="prolang"]').val(),
            }, function (data) {

            });
        }

        function stop() {
            $.getJSON('/stop', {
                prolang: $('input[name="prolang"]').val(),
            }, function (data) {

            });
        }

        function right() {
            $.getJSON('/right', {
                prolang: $('input[name="prolang"]').val(),
            }, function (data) {

            });

        }

    </script>
</body>

</html>